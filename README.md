Based on https://www.drupal.org/node/2265637
